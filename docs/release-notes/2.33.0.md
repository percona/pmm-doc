# Percona Monitoring and Management 2.33.0

| **Release date:** | Dec 13, 2022                                                                                    |
| ----------------- | ----------------------------------------------------------------------------------------------- |
| **Installation:** | [Installing Percona Monitoring and Management](https://www.percona.com/software/pmm/quickstart) |

Percona Monitoring and Management (PMM) is an open source database monitoring, management, and observability solution for MySQL, PostgreSQL, and MongoDB.

!!! caution alert alert-warning "Important"
    We recommend using the latest version of PMM. This ensures that you have access to the latest PMM features and that your environment runs on the latest version of the underlying components, such as VictoriaMetrics, with all the bug fixes in place.

## Release Highlights


### High Availability in PMM


We are happy to share our roadmap for High Availability (HA) in PMM, a new architectural design that provides near-zero downtime of your PMM setup and ensures monitoring without data loss during a failover. High availability in PMM is a new solution that our users have eagerly anticipated. 

The PMM HA will be rolled out in three stages based on user feedback and requirements, with PMM 2.33.0 being the first stage. Stage two and stage three will be rolled out next year.

The following features/use cases will be covered as part of the various stages of HA in PMM:

**Stage 1**

As a first step toward preventing data loss, we have developed the following solution:

**Prevent data loss with VM integration for short outages**

If PMM Server goes down, metrics will be buffered on the monitored instance until PMM Server comes back online, which is when metrics will get pushed to PMM Server. Note that this only applies to PMM Clients which run in the so-called `push` mode. The same holds true when a brief network outage occurs on the client side.

**Stage 2**

As part of PMM HA stage two in HA we plan to implement the following:

**HA data sources**

As part of stage two we will let the users use external data sources therby decreasing dependency on the file system.


**Stage 3**

As part of PMM HA stage three we plan to implement the following:

**Clusterized HA**

Stage three will be about clusterized PMM. Details will be shared in the subsequesnt Release Notes.






### Restore MongoDB backups easier

Building on the major improvements for MongoDB Backup Management introduced in the previous release, we are now simplifying the process for restoring physical MongoDB backups. 

Starting with this release,  you can restore physical backups straight from the UI, instead of using Percona Server for MongoDB.  In addition, you no longer need to perform additional manual operations after restoring the physical backup.

### Guided tour of Percona Alerting

Follwing on the recent improvements to PMM Alerting, weâ€™ve now added a short tutorial to help you explore easier our streamlined alerting system based on Grafana.

The in-app tutorial automatically pops up when you first open the **Alerting** page to help you uncover the fundamentals of Percona Alerting.

## New Features

[PMM-10889](https://jira.percona.com/browse/PMM-10889) - Starting with PMM2.33.0, while using the pmm-admin CLI command, you do not have to know the entire command. Just type the initial command and press Tab. The rest of the command will be autocompleted.

Depending on the shell you are using, add the following to your shells .rc file for autocomplete to work:

```sh
source <(pmm-admin completion -c <your shell>)
E.g. source <(pmm-admin completion -c bash)
```

[PMM-10955](https://jira.percona.com/browse/PMM-10955) - Timestamps for point-in-time recovery (PITR) restore. After restoring a PITR backup, you can now check the time when you started the restore and the time when the restore was finalized. This information is available in the new **Started at** and **Finished at** columns under **Backup > Restores**.

Components Upgrade: VictoriaMetrics has been upgraded from 1.77.1 to 1.82.1.

### Components Upgrade

- VictoriaMetrics has been upgraded from 1.77.1 to 1.82.1.
- As part of PMM 2.33.0, grafana has been updated to 9.2.5, which fixes some critical vulnerabilities. For more information, see [grafana 9.2.5](https://grafana.com/blog/2022/11/08/security-release-new-versions-of-grafana-with-critical-and-moderate-fixes-for-cve-2022-39328-cve-2022-39307-and-cve-2022-39306/)

## Improvements

- [PMM-9946](https://jira.percona.com/browse/PMM-9946): [DBaaS]: To enhance user experience, once PMM is deployed to a Kubernetes cluster and a user wants to use DBaaS, PMM automatically registers that Kubernetes cluster to DBaaS.

- [PMM-10733](https://jira.percona.com/browse/PMM-10733): [DBaaS]: We have moved another step forward in simplifying the use of DBaaS by simplifying the selection of the database version.

- [PMM-8516] - [Backup management]: When creating an a backup, the **Vendor** field was not automatically populated in the Back-up on demand dialog. This issue is now fixed.
- 
- [PMM-10723](https://jira.percona.com/browse/PMM-10723): [DBaaS]: To make the content legible, we have changed the color of the notification block.

- [PMM-10156](https://jira.percona.com/browse/PMM-10156): [Dashboard]: Starting with PMM 2.32.0, we have an enhanced PMM dashboard that gives a birds-eye view of the services, infrastructure, and critical issues (if any).
 - [PMM-10612](https://jira.percona.com/browse/PMM-10612): [Dashboard]: You can now easily access all dashboards for monitored services. Dashboards in the services folder (MySQL dashboards) that were not accessible from the main menu are now accessible from **Other Dashboards**.
 
 - [PMM-10695](https://jira.percona.com/browse/PMM-10695): [Dashboard]: For precision, we have added a unit (%) for the CPU Anomalies panel.

- [PMM-10487](https://jira.percona.com/browse/PMM-10487): [Dashboard]: Our Experimental MongoDB dashboards are now equipped with tooltips to help you understand the information provided in the panels.

- [PMM-10692](https://jira.percona.com/browse/PMM-10692): [Dashboard]: Enhanced the High CPU Usage, High Disk Queue, and High Memory Usage panels to make the troubleshooting process easier and more actionable. Just click the node name on the panel to see the details of the problem.

- [PMM-10751](https://jira.percona.com/browse/PMM-10751): [Dashboard]: For the Vacuum dashboard, when filtering by Service name, the first panel that shows the service name and resolution was hidden due to the Disclaimer. It has now been moved above the Disclaimer to make it readable.

- [PMM-10690](https://jira.percona.com/browse/PMM-10690): [Dashboard]: Starting with PMM 2.32.0, we have enabled sparklines for Disk Read and Write panels to visually represent and show trends in the data.

- [PMM-10697](https://jira.percona.com/browse/PMM-10697): [Dashboard]: We have improved the visualization of the Used Memory Anomaly Panel on the Home Dashboard so that all the anomalies are visible.

- [PMM-10694](https://jira.percona.com/browse/PMM-10694): [Dashboard]: Added and refined tooltips for all the panels on the dashboard.

- [PMM-10721](https://jira.percona.com/browse/PMM-10721): On the **Explore dashboard**, **Metrics panel**, removed the links pointing to the Grafana discussion board.

- [PMM-10662](https://jira.percona.com/browse/PMM-10662), [PMM-10633](https://jira.percona.com/browse/PMM-10633), [PMM-10631](https://jira.percona.com/browse/PMM-10631), [PMM-10600](https://jira.percona.com/browse/PMM-10600): An additional MySQL and MongoDB related datapoints have been added to Telemetry.

- [PMM-10393](https://jira.percona.com/browse/PMM-10393): The panel for total time taken for scraping metrics by Postgres exporter is improved. Instead of showing coarse-grained measurements of the total time taken by the exporter, it now shows the total time taken per collector.

- [PMM-10555](https://jira.percona.com/browse/PMM-10555): Runtime for collectors in MongoDB exporter is pushed via Telemetry to  PMM. This information detects considerable scrape time for collectors and improves collector performance in future releases.

- [PMM-10908](https://jira.percona.com/browse/PMM-10908): [Platform integration]: Improved error message displayed when while connecting to Percona Portal with an expired token.


## Bugs Fixed

- [PMM-10944](https://jira.percona.com/browse/PMM-10944): [Backup Management]: Fixed an issue that was preventing QAN to retrieve data after a restore for MongoDB with authentication enabled.

- [PMM-10840](https://jira.percona.com/browse/PMM-10840): [Alerting]: Fixed embedded templates that are using expressions like **x == 0**  or **x != 0**. 
PMM servers connected to Percona Platform already include this fix, since Percona Platform delivered it via Automatic Template Updates, a couple of weeks ago.

- [PMM-10759](https://jira.percona.com/browse/PMM-10759): [Alerting]:  Renamed the **Alerting** option in the PMM Settings to **Percona Alerting**. Since this option refers to Percona Alert Rule Templates, this new label reflects better the fact that this option is different from the basic, built-in Alerting functionality.

- [PMM-10810](https://jira.percona.com/browse/PMM-10810): [Alerting]:  Fired alerts now show the correct summary, which includes the node or service name specified in the template annotations.

- [PMM-10500](https://jira.percona.com/browse/PMM-10500): [DBaaS]: DBaaS: Fixed an issue where a database cluster for an unregistered k8s cluster was still being displayed on the UI.

- [PMM-10640](https://jira.percona.com/browse/PMM-10640): [DBaaS 1.10, 1.11]: Fixed an issue where a MongoDB 5.0.x cluster was not getting created.

- [PMM-9874](https://jira.percona.com/browse/PMM-9874): [Dashboard]: Fixed an issue where the current ReplSet State stat is unreadable after modifying or restarting the database cluster for MongoDB Dashboard.

- [PMM-10339](https://jira.percona.com/browse/PMM-10339): [Dashboard]: Fixed the duplicate values displayed on the CPU usage charts for MongoDB and MySQL dashboards.

- [PMM-10802](https://jira.percona.com/browse/PMM-10802): [Advisors]: Fixed **MongoDBGetDiagnosticData** and **MongoDBReplSetGetStatus** query type for Advisors Checks V2.

- [PMM-10688](https://jira.percona.com/browse/PMM-10688): This bug fix restores the ability to copy existing kubeconfig and register a new cluster by provided copy. However, AWS secrets will be hidden in the UI.

- [PMM-10996](https://jira.percona.com/browse/PMM-10996)- Fixed an issue where the initial description text for a storage location could not be updated. 
  

## Known Issues

[PMM-11029](https://jira.percona.com/browse/PMM-11029): **pmm-agent: killed when --max-query-length <=3**

If the value of the parameter `max-query-length` is set to 3, 2 or 1, the PMM agent will get terminated.

**Solution**

The value of the parameter should be greater than 3.


